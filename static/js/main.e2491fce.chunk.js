(this["webpackJsonphelium-accounting-tool"]=this["webpackJsonphelium-accounting-tool"]||[]).push([[0],{156:function(e,t,n){},158:function(e,t,n){},169:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(49),i=n.n(o),s=n(84),c=n(16),l=(n(156),n(74)),u=n(8),h=n(248),d=n(180),m=n(246),b=n(252),j=n(78),f=n(60),p=n(240),O=n(70),g=n.n(O),v=n(239),w=n(241),x=(n(158),n(14));function y(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&(200===a.status?t(JSON.parse(a.responseText)):n("server rejected request"))},a.open("GET",e),a.send()}))}function Y(e,t){return console.log("calling iterable request"),y(e).then((function(n){var a=t;return n.hasOwnProperty("data")&&(console.log("adding more entries",t.length,n.data.length),a.push.apply(a,Object(x.a)(n.data))),n.hasOwnProperty("cursor")?Y(e.slice(0,e.indexOf("&cursor="))+"&cursor="+n.cursor,a):a}))}function H(e){return new Promise((function(t,n){y(e).then((function(n){if(n.hasOwnProperty("cursor")){var a=e.slice(0,e.indexOf("&cursor="))+"&cursor="+n.cursor;t(Y(a,n.data))}else t(n.data)}))}))}function S(e){return function(e){var t=new Map;return Promise.all(e.map((function(e,t,n){return H("https://api.helium.io/v1/hotspots/"+e)}))).then((function(e){console.log(e),e.forEach((function(e,n,a){t.set(e.address,e.name.replace(/-/g," "))}))})).then((function(){return t}))}(Object(x.a)(e.reduce((function(e,t){return e.set(t.gateway,t.gateway),e}),new Map).values())).then((function(t){return e.map((function(e,n){var a=e.amount/1e8;return{timestamp:e.timestamp,minerHash:e.gateway,minerName:t.get(e.gateway),block:e.block,amount:a,id:n}}))}))}var M=n(88),D=n(1),C=[{field:"timestamp",headerName:"Time stamp (UTC)",width:150},{field:"minerHash",headerName:"Miner Hash",width:150},{field:"minerName",headerName:"Miner Name",width:150},{field:"block",headerName:"Block Number",width:150},{field:"amount",headerName:"Amount",width:150}];var N=function(){var e=r.a.useState(""),t=Object(u.a)(e,2),n=t[0],a=t[1],o=r.a.useState(""),i=Object(u.a)(o,2),c=i[0],O=i[1],x=r.a.useState(null),y=Object(u.a)(x,2),Y=y[0],N=y[1],T=r.a.useState(null),k=Object(u.a)(T,2),P=k[0],_=k[1],E=r.a.useState(!1),I=Object(u.a)(E,2),F=I[0],B=I[1],R=r.a.useState([]),q=Object(u.a)(R,2),L=q[0],A=q[1],J=r.a.useState("hotspot"),U=Object(u.a)(J,2),V=U[0],X=U[1],z=Object(s.b)(),G=Object(u.a)(z,1)[0];return r.a.useEffect((function(){var e=G.get("hs");null!==e&&a(e);var t=G.get("ow");null!==t&&O(t),null===e&&null!==t&&X("owner");var n=G.get("start");if(null!==n){var r=g.a.utc(n,"YYYYMMDDTHH:mm:ss");r.isValid()&&N(r)}var o=G.get("end");if(null!==o){var i=g.a.utc(o,"YYYYMMDDTHH:mm:ss");i.isValid()&&_(i)}}),[G]),Object(D.jsxs)("div",{className:"App",children:[Object(D.jsx)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"}),Object(D.jsx)(h.a,{sx:{height:"70vh",marginBottom:50},children:Object(D.jsxs)(v.b,{dateAdapter:p.a,children:[Object(D.jsxs)(d.a,{my:2,children:[Object(D.jsx)(d.a,{mb:1,children:Object(D.jsxs)(m.a,{value:V,exclusive:!0,color:"primary",fullWidth:!0,onChange:function(e,t){null!==t&&X(t)},"aria-label":"Choose between hotspot or owner as data source",children:[Object(D.jsx)(b.a,{value:"hotspot","aria-label":"hotspot",children:"Hotspot"}),Object(D.jsx)(b.a,{value:"owner","aria-label":"owner",children:"Owner"})]})}),"hotspot"===V?Object(D.jsx)(j.a,{value:n,maxRows:1,style:{width:500},id:"hotspot_address",label:"Hotspot address",variant:"outlined",onChange:function(e){a(e.target.value)}}):Object(D.jsx)(j.a,{value:c,maxRows:1,style:{width:500},id:"owner_address",label:"Owner address",variant:"outlined",onChange:function(e){O(e.target.value)}})]}),Object(D.jsx)(d.a,{my:2,children:Object(D.jsx)(w.a,{label:"Start Date (UTC)",value:Y,inputFormat:"YYYY/MM/DD HH:mm:ss",onChange:function(e){console.log(e),null!==e&&N(e)},renderInput:function(e){return Object(D.jsx)(j.a,Object(l.a)(Object(l.a)({},e),{},{style:{width:500}}))}})}),Object(D.jsx)(d.a,{my:2,children:Object(D.jsx)(w.a,{label:"End Date (UTC)",value:P,minDate:Y,inputFormat:"YYYY/MM/DD HH:mm:ss",clearable:!0,onChange:function(e){null!==e&&_(e)},renderInput:function(e){return Object(D.jsx)(j.a,Object(l.a)(Object(l.a)({},e),{},{style:{width:500}}))}})}),Object(D.jsx)(d.a,{mt:2,mb:4,children:Object(D.jsx)(f.a,{variant:"contained",size:"large",onClick:function(e){console.log("clicked button"),null!==Y&&null!==P&&("hotspot"===V?(B(!0),A([]),function(e,t,n){var a=t.toISOString(!1),r=n.toISOString(!1);return console.log("getting rewards for",e,a,r),H("https://api.helium.io/v1/hotspots/"+e+"/rewards?max_time="+r+"&min_time="+a).then((function(e){return S(e).then((function(e){return e}))}))}(n,Y,P).then((function(e){A(e)})).finally((function(){B(!1)}))):"owner"===V&&(B(!0),A([]),function(e,t,n){var a=t.toISOString(!1);return H("https://api.helium.io/v1/accounts/"+e+"/rewards?max_time="+n.toISOString(!1)+"&min_time="+a).then((function(e){return S(e).then((function(e){return e}))}))}(c,Y,P).then((function(e){A(e)})).finally((function(){B(!1)}))))},disabled:null===Y||null===P,children:F?"Pulling data":"Fetch rewards"})}),Object(D.jsx)(M.a,{rows:L,columns:C,style:{maxHeight:"100vh",marginBottom:16},components:{Toolbar:function(){return Object(D.jsx)(M.b,{style:{justifyContent:"center",display:L.length>0?"block":"none"},children:Object(D.jsx)(M.c,{csvOptions:{allColumns:!0,fileName:null!==Y&&null!==P?"heliumExport_"+V+"_"+Y.format("YYYYMMDD-HH mm")+"_"+P.format("YYYYMMDD-HHmm")+".csv":"heliumExport.csv"},printOptions:{disableToolbarButton:!0}})})}}})]})})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,253)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};i.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(s.a,{basename:"/".concat("https://anbifa.github.io/helium-accounting-tool"),children:Object(D.jsx)(c.c,{children:Object(D.jsx)(c.a,{path:"",element:Object(D.jsx)(N,{})})})})}),document.getElementById("root")),T()}},[[169,1,2]]]);
//# sourceMappingURL=main.e2491fce.chunk.js.map